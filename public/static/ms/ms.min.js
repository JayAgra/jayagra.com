var board=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,],flagged=[];const waitMs=e=>new Promise(t=>setTimeout(t,e));var boardElements=[],enableEvents=!0,tileReveals=0,gameStartedTime=Math.floor(Date.now()/1e3),bombsRemaining=10;function updateTimer(){0===tileReveals?gameStartedTime=Math.floor(Date.now()/1e3):document.getElementById("time").innerHTML=String(Math.floor(Date.now()/1e3)-gameStartedTime).padStart(3,"0")}const timerInterval=window.setInterval(updateTimer,1e3);function generateBombs(){for(var e=0;e<10;e+=1){let t=Math.floor(81*Math.random());9===board[t]?e-=1:board[t]=9}}function confirmSameRow(e,t){return(e-e%9)/9===t}function returnValueIfNotExists(e,t,s){return e<0||e>80?t:confirmSameRow(e,s)?board[e]:t}function rowOfNum(e){return(e-e%9)/9}function findNumberOfNbrs(e){if(9===board[e])return 9;var t=0;return 9===returnValueIfNotExists(e-10,0,rowOfNum(e)-1)&&(t+=1),9===returnValueIfNotExists(e-9,0,rowOfNum(e)-1)&&(t+=1),9===returnValueIfNotExists(e-8,0,rowOfNum(e)-1)&&(t+=1),9===returnValueIfNotExists(e-1,0,rowOfNum(e))&&(t+=1),9===returnValueIfNotExists(e+1,0,rowOfNum(e))&&(t+=1),9===returnValueIfNotExists(e+8,0,rowOfNum(e)+1)&&(t+=1),9===returnValueIfNotExists(e+9,0,rowOfNum(e)+1)&&(t+=1),9===returnValueIfNotExists(e+10,0,rowOfNum(e)+1)&&(t+=1),t}function exposeTileIfEmpty(e,t){e>=0&&e<81&&confirmSameRow(e,t)&&processClick("c_"+e,!0)}function exposeEmptyArea(e){0===board[e]&&(exposeTileIfEmpty(e-8,rowOfNum(e)-1),exposeTileIfEmpty(e-9,rowOfNum(e)-1),exposeTileIfEmpty(e-10,rowOfNum(e)-1),exposeTileIfEmpty(e-1,rowOfNum(e)),exposeTileIfEmpty(e+1,rowOfNum(e)),exposeTileIfEmpty(e+8,rowOfNum(e)+1),exposeTileIfEmpty(e+9,rowOfNum(e)+1),exposeTileIfEmpty(e+10,rowOfNum(e)+1))}function revealEntireBoard(){for(var e=0;e<81;e+=1)-1!==board[e]&&0!==board[e]&&(9===board[e]?document.getElementById("c_"+e).src="static/ms/assets/14.png":-1===board[e]||0===board[e]?document.getElementById("c_"+e).src="static/ms/assets/08.png":document.getElementById("c_"+e).src="static/ms/assets/"+String(board[e]-1).padStart(2,"0")+".png")}var numberColorClasses=["clear","one","two","three","four","five","six","seven","eight",];function checkwin(){for(var e=0,t=0;t<flagged.length;t+=1)9===board[Number(flagged[t].slice(2))]&&(e+=1);return 10===e}function processClick(e,t){if(enableEvents){if(flagged.includes(e)&&!t)confirm("Are you sure you would like to select a flagged box?")&&(bombsRemaining-=1,document.getElementById("score").innerHTML=String(bombsRemaining).padStart(3,"0"),flagged=flagged.filter(t=>t!==e),document.getElementById(e).src="static/ms/assets/09.png",processClick(e,!0));else if(flagged.includes(e)&&t)bombsRemaining+=1,document.getElementById("score").innerHTML=String(bombsRemaining).padStart(3,"0"),flagged=flagged.filter(t=>t!==e),document.getElementById(e).src="static/ms/assets/09.png",processClick(e,!0);else{tileReveals+=1,document.getElementById("score").innerHTML=String(bombsRemaining).padStart(3,"0");var s=Number(e.slice(2));if(-1===board[s]){var r=document.getElementById(e);let n=findNumberOfNbrs(s);board[s]=n,0!==n?r.src="static/ms/assets/"+String(n-1).padStart(2,"0")+".png":0===n&&(r.src="static/ms/assets/08.png",exposeEmptyArea(s)),r.classList.add("clear"),r.classList.add(numberColorClasses[n]),checkwin()&&(alert("w"),revealEntireBoard(),window.clearInterval(timerInterval))}else if(9===board[s]){console.log("boom."),document.getElementById("smiley").src="static/ms/assets/sad.png",document.getElementById(e).src="static/ms/assets/15.png";var r=document.getElementById(e);r.style.color="#f00",enableEvents=!1,revealEntireBoard(),window.clearInterval(timerInterval),document.getElementById(e).src="static/ms/assets/15.png"}}}}function processRightClick(e,t){enableEvents&&(-1===board[Number(e.slice(2))]||9===board[Number(e.slice(2))])&&(flagged.includes(e)?(bombsRemaining+=1,document.getElementById("score").innerHTML=String(bombsRemaining).padStart(3,"0"),document.getElementById(e).src="static/ms/assets/09.png",flagged=flagged.filter(t=>t!==e)):(bombsRemaining>0&&(bombsRemaining-=1,document.getElementById("score").innerHTML=String(bombsRemaining).padStart(3,"0"),document.getElementById(e).src="static/ms/assets/10.png",flagged.push(e)),0===bombsRemaining&&checkwin()&&(enableEvents=!1,revealEntireBoard(),window.clearInterval(timerInterval),document.getElementById("smiley").src="static/ms/assets/happy.png")))}function playGame(){for(var e=0;e<81;e+=1){let t=document.createElement("img");t.src="static/ms/assets/09.png",t.setAttribute("id","c_"+e),t.classList.add("pgrid-c"),t.ondragstart=function(){return!1},document.getElementById("ms_grid").appendChild(t)}generateBombs(),boardElements=Array.from(document.getElementById("ms_grid").children);for(var e=0;e<81;e+=1)boardElements[e].addEventListener("click",function(e){processClick(this.id,!1)}),boardElements[e].addEventListener("contextmenu",function(e){e.preventDefault(),processRightClick(this.id,e)},!1)}function resetGame(){window.location.reload()}async function closeButton(){await new Audio("static/ms/assets/shutdown.mp3").play(),document.getElementById("mswpr-window").style.display="none"}async function minimizeButton(){await new Audio("static/ms/assets/error.mp3").play()}function toggleFullScreen(){window.screenTop||window.screenY?document.getElementById("mswpr-window").requestFullscreen():document.exitFullscreen()}function openGitHub(){window.open("https://github.com/JayAgra/minesweeper-js","_blank")}